# 🎯 题库识别系统 - 完整使用说明

## 🚀 快速开始（1分钟上手）

### 1. 准备题库文件
将您的题库文件放在 `../题库/` 目录下：
```
题库/
├── 电力安全工作规程题库.xlsx
├── 新员工竞赛题库.xlsx
└── 其他题库文件...
```

### 2. 运行系统
```bash
cd question-recog
python enhanced_system.py
```

### 3. 查看结果
- 屏幕显示识别进度和统计
- 详细结果保存在 `enhanced_results.json`

## 📊 系统能力

### ✅ 支持的文件格式
- **Excel文件** (.xlsx) - **推荐**，识别效果最好
- **Word文档** (.docx) - 支持良好
- **PDF文档** (.pdf) - 基础支持

### ✅ 支持的题型
- **填空题** - 包含 `____`、`（）` 等空白标记
- **判断题** - 对/错、√/× 类型题目
- **选择题** - A、B、C、D 选项题目（开发中）
- **简答题** - 开放式问答题目（开发中）

### ✅ 识别精度
- **当前版本**：340题目，100%高置信度
- **主要题型**：填空题(68.8%) + 判断题(31.2%)

## 📋 详细使用教程

### 🔧 环境准备

1. **安装依赖**
```bash
pip install -r requirements.txt
```

2. **检查Python版本**
```bash
python --version  # 推荐 Python 3.8+
```

### 📄 文件格式要求

#### Excel格式（推荐）
```
1 运用中的电气设备是指：____或____及____的电气设备。
答案：全部带有电压、一部分带有电压、一经操作即带有电压

2 装设接地线可以单人进行。
答案：×
```

#### 关键要求：
- 题目以数字开头（如 "1 "、"2 "）
- 答案用 "答案：" 标记
- 每题占用连续的行

### 🚀 运行系统

#### 基础运行
```bash
python enhanced_system.py
```

#### 查看帮助
```bash
python enhanced_system.py --help
```

### 📊 结果解读

#### 屏幕输出示例
```
🚀 测试增强版题目识别系统
==================================================
📄 处理文件: 电力安全工作规程题库.xlsx
  📊 识别到 339 个题目

📊 处理总结
题目总数: 340

📈 题型分布:
  fill_blank     :  234 题 ( 68.8%)
  true_false     :  106 题 ( 31.2%)

🎯 置信度分布:
  high      :  340 题 (100.0%)
```

#### 结果文件格式
`enhanced_results.json` 包含：
```json
[
  {
    "source_id": "file://题库.xlsx#q1",
    "question": "运用中的电气设备是指：____或____及____的电气设备。",
    "options": [],
    "answer_raw": "全部带有电压、一部分带有电压、一经操作即带有电压",
    "predicted_type": "fill_blank",
    "confidence": 0.9,
    "method": "enhanced_rule_based"
  }
]
```

## 🔧 高级功能

### 1. 自定义配置
编辑 `configs/` 目录下的配置文件：
- `app.yaml` - 主要配置
- `features.yaml` - 特征配置
- `rules.yaml` - 规则配置

### 2. 模型训练（可选）
```bash
# 扩展训练数据
python tools/expand_data.py

# 训练XGBoost模型
python train_model.py

# 测试模型效果
python tools/test_trained_model.py
```

### 3. 批量处理
将多个题库文件放在 `../题库/` 目录，系统会自动处理所有支持的文件。

## ❓ 常见问题

### Q1: "题库目录不存在"
**解决**：
```bash
# 创建题库目录
mkdir ../题库
# 将题库文件放入该目录
```

### Q2: 识别效果不好
**解决**：
1. 检查文件格式是否符合要求
2. 优先使用Excel格式
3. 确保题目编号格式正确

### Q3: 想要识别更多题型
**解决**：
1. 查看 `enhanced_system.py` 中的分类规则
2. 根据需要添加新的识别模式
3. 或联系开发者扩展功能

### Q4: 处理大量文件很慢
**解决**：
1. 分批处理文件
2. 使用SSD硬盘
3. 关闭其他占用内存的程序

## 📈 性能优化建议

### 1. 文件格式优化
- 🥇 **Excel (.xlsx)** - 最佳选择
- 🥈 **Word (.docx)** - 次优选择  
- 🥉 **PDF (.pdf)** - 尽量避免

### 2. 题库格式优化
- ✅ 题目编号清晰（1、2、3...）
- ✅ 答案标记统一（答案：）
- ✅ 避免复杂排版
- ✅ 一题一段，结构清晰

### 3. 系统性能优化
- ✅ 使用SSD硬盘
- ✅ 确保足够内存（推荐8GB+）
- ✅ 关闭不必要的程序

## 🛠️ 故障排除

### 常见错误及解决方案

#### 1. 导入错误
```bash
# 错误：ModuleNotFoundError
# 解决：安装依赖
pip install pandas openpyxl python-docx
```

#### 2. 编码错误
```bash
# 错误：UnicodeDecodeError
# 解决：确保文件编码为UTF-8
```

#### 3. 内存不足
```bash
# 错误：MemoryError
# 解决：分批处理文件，减少单次处理量
```

## 🎯 使用技巧

### 1. 提高识别率
- 使用标准化的题目格式
- 确保答案标记清晰
- 避免特殊字符和复杂排版

### 2. 批量处理
- 按文件类型分组处理
- 先处理Excel，再处理Word
- 大文件分割后处理

### 3. 结果验证
- 检查置信度分布
- 人工抽查部分结果
- 关注unknown类型的题目

## 📞 技术支持

### 获取帮助
1. 查看 `docs/` 目录下的详细文档
2. 检查 `📁文件结构说明.md`
3. 查看系统日志和错误信息

### 反馈问题
请提供：
1. 错误信息截图
2. 问题题库文件示例
3. 系统环境信息

## 🎉 开始使用

**最简单的使用方式：**
```bash
# 1. 进入系统目录
cd question-recog

# 2. 运行系统
python enhanced_system.py

# 3. 查看结果
# 屏幕显示 + enhanced_results.json 文件
```

**恭喜！您已经掌握了题库识别系统的完整使用方法！** 🚀

---

*最后更新：2025年10月12日*  
*版本：v2.0 Enhanced*
